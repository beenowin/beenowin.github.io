{"version":3,"file":"js/433.0cfbd1f1.js","mappings":"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","sources":["webpack://q-front/./src/pages/HomePage.vue","webpack://q-front/./src/pages/HomePage.vue?fce1","webpack://q-front/./src/pages/HomePage.vue?575b","webpack://q-front/./src/pages/HomePage.vue?dda4"],"sourcesContent":["<template>\n  <q-page class=\"home container\">\n    <div id=\"tgme_background\" class=\"tgme_background\" />\n\n    <div class=\"lists-tab sidebar\" :class=\"{ 'stick-to-top': isSticky }\">\n      <div id=\"lists-tab-box\">\n        <div class=\"\">\n          <div v-for=\"list in lists\" :key=\"list.id\">\n            <button\n              :title=\"list[locale]\"\n              class=\"list-tab-button\"\n              :class=\"{ active: list.name === activeListName }\"\n              @click=\"changeActiveCategory(list.name)\"\n            >\n              {{ list[locale] }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <button\n      v-if=\"newPostsCount !== 0\"\n      class=\"load-new-posts\"\n      :title=\"`${$t('load_more')}(${newPostsCount})`\"\n      @click=\"loadNewPosts\"\n    >\n      {{ $t('load_more') }}({{ newPostsCount > 9 ? '10+' : newPostsCount }})\n    </button>\n\n    <div ref=\"scrollComponent\" class=\"posts\">\n      <post-item v-for=\"post in posts\" :key=\"post._id\" :post=\"post\" />\n      <div class=\"post-loading\">\n        <img v-if=\"isLoading\" src=\"@/assets/img/loader.gif\" alt=\"\" />\n      </div>\n    </div>\n  </q-page>\n</template>\n\n<script>\nimport PostItem from '@/components/PostItem';\nimport { computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { ref } from 'vue';\nimport { onMounted, onUnmounted } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport {\n  RequestPreloadQueue,\n  ChannelService,\n  PostsCounterService,\n} from '@/services';\n\nexport default {\n  components: {\n    PostItem,\n  },\n  setup() {\n    const scrollComponent = ref(null);\n    const isSticky = ref(false);\n    const lists = ref([]);\n\n    const activeCategory = localStorage.getItem('category') || 'all';\n    const { locale } = useI18n({ useScope: 'global' });\n\n    const activeListName = ref(activeCategory);\n    const isLoading = ref(false);\n\n    const store = useStore();\n    const postsCounterService = new PostsCounterService(store);\n\n    const posts = computed(() => store.getters['post/items']);\n    const newPostsCount = computed(() => store.getters['post/newPostsCount']);\n\n    const loadPosts = async () => {\n      isLoading.value = true;\n\n      postsCounterService.clearPostsCountInterval();\n\n      const category = activeListName.value;\n\n      await store.dispatch('post/loadPosts', {\n        category,\n      });\n\n      postsCounterService.initPostsCountInterval(category);\n\n      isLoading.value = false;\n    };\n\n    const loadNewPosts = async () => {\n      await loadPosts();\n    };\n\n    const loadMorePosts = async () => {\n      isLoading.value = true;\n\n      await store.dispatch('post/loadMorePosts', {\n        category:  activeListName.value,\n      });\n\n      isLoading.value = false;\n    };\n\n    const changeActiveCategory = async (name) => {\n      if (typeof window === 'undefined') {\n        return;\n      }\n\n      if (isLoading.value) {\n        return;\n      }\n\n      activeListName.value = name;\n      localStorage.setItem('category', name);\n      await loadPosts();\n\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    };\n\n    window.app.methods.changeActiveCategory = changeActiveCategory;\n\n    const handleScroll = async () => {\n      if (typeof window === 'undefined') {\n        return;\n      }\n\n      if (window.scrollY > 80) {\n        isSticky.value = true;\n      } else {\n        isSticky.value = false;\n      }\n\n      if (isLoading.value) {\n        return;\n      }\n\n      let element = scrollComponent.value;\n\n      if (element.getBoundingClientRect().bottom - 30 < window.innerHeight) {\n        await loadMorePosts();\n      }\n    };\n\n    const setCategoryLists = async (lists) => {\n      lists.value = await ChannelService.getChannelsCategories();\n      // move active category to first position\n      const activeCategoryIndex = lists.value.findIndex(\n        (list) => list.name === activeListName.value,\n      );\n      const activeCategory = lists.value.splice(activeCategoryIndex, 1);\n\n      lists.value = lists.value.filter((list) => list.visible);\n\n      lists.value.unshift(activeCategory[0]);\n    };\n\n    window.app.methods.setCategoryLists = setCategoryLists;\n\n    onMounted(async () => {\n      if (!posts.value.length) {\n        await RequestPreloadQueue.addRequest(loadPosts);\n      }\n\n      await setCategoryLists(lists);\n\n      window.addEventListener('scroll', handleScroll);\n    });\n\n    onUnmounted(() => {\n      window.removeEventListener('scroll', handleScroll);\n      postsCounterService.clearPostsCountInterval();\n    });\n\n    return {\n      isSticky,\n      activeListName,\n      lists,\n      scrollComponent,\n      posts,\n      isLoading,\n      locale,\n      newPostsCount,\n      loadMorePosts,\n      loadNewPosts,\n      changeActiveCategory,\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.home {\n  width: 100%;\n  min-height: 100vh;\n\n  @media (max-width: 700px) {\n    padding: 0;\n  }\n}\n\n.load-new-posts {\n  width: 100%;\n  border: 0;\n  padding: 9px 0;\n  border-radius: 9px;\n  margin: 10px auto;\n  display: block;\n\n  @media (max-width: 700px) {\n    width: calc(100% - 10px);\n  }\n}\n\n.lists-tab {\n  overflow: hidden;\n  padding: 0 5px;\n  // padding: 10px 0 10px;\n\n  &.sidebar {\n    position: absolute;\n    margin-top: 10px;\n    margin-left: -110px;\n    top: 0;\n\n    &.stick-to-top {\n      position: fixed;\n      margin-top: 12px;\n    }\n\n    .list-tab-button {\n      width: 100%;\n      padding: 10px;\n      text-align: center;\n      margin: 0 0 10px 0;\n      border-radius: 20px;\n    }\n  }\n\n  @media (max-width: 700px) {\n    &.sidebar {\n      display: none;\n    }\n  }\n}\n\n.list-tab-button {\n  border: none;\n  // width: 100%;\n  padding: 5px;\n  border-radius: 9px;\n  background-color: #f5f5f5;\n  transition: all 0.1s ease;\n\n  &.active {\n    background: #ffd700 !important;\n    transform: scale(0.97);\n  }\n}\n\n.posts {\n  padding: 10px 0;\n  position: relative;\n  z-index: 1;\n}\n\n.post {\n  background-color: #000;\n}\n\n.loadMoreButton {\n  display: flex;\n  align-items: center;\n  height: 44px;\n  font-size: 16px;\n  cursor: pointer;\n  margin: 0 auto 3px;\n  border-radius: 8px;\n  padding: 0 13px;\n  background-color: #fff;\n  border: none;\n}\n\n.post-loading {\n  img {\n    width: 45px;\n    display: block;\n    margin: 14px auto 0;\n  }\n}\n</style>\n","export * from \"-!../../node_modules/@quasar/app-webpack/lib/webpack/loader.js.transform-quasar-imports.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-2.use[0]!../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[3]!../../node_modules/@quasar/app-webpack/lib/webpack/loader.vue.auto-import-quasar.js??ruleSet[0].use[0]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./HomePage.vue?vue&type=template&id=46cd15ee\"","export { default } from \"-!../../node_modules/@quasar/app-webpack/lib/webpack/loader.js.transform-quasar-imports.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-2.use[0]!../../node_modules/@quasar/app-webpack/lib/webpack/loader.vue.auto-import-quasar.js??ruleSet[0].use[0]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./HomePage.vue?vue&type=script&lang=js\"; export * from \"-!../../node_modules/@quasar/app-webpack/lib/webpack/loader.js.transform-quasar-imports.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-2.use[0]!../../node_modules/@quasar/app-webpack/lib/webpack/loader.vue.auto-import-quasar.js??ruleSet[0].use[0]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./HomePage.vue?vue&type=script&lang=js\"","import { render } from \"./HomePage.vue?vue&type=template&id=46cd15ee\"\nimport script from \"./HomePage.vue?vue&type=script&lang=js\"\nexport * from \"./HomePage.vue?vue&type=script&lang=js\"\n\nimport \"./HomePage.vue?vue&type=style&index=0&id=46cd15ee&lang=scss\"\n\nimport exportComponent from \"/home/pc/coding/beenow-4/front/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__\nimport QPage from 'quasar/src/components/page/QPage.js';\nimport qInstall from \"../../node_modules/@quasar/app-webpack/lib/webpack/runtime.auto-import.js\";\nqInstall(script, 'components', {QPage});\n"],"names":["_imports_0","_createElementVNode","id","class","ref","src","alt","_createBlock","_component_q_page","_hoisted_1","_normalizeClass","$setup","isSticky","_hoisted_2","_hoisted_3","_createElementBlock","_Fragment","_renderList","lists","list","key","title","locale","active","name","activeListName","onClick","$event","changeActiveCategory","_hoisted_4","newPostsCount","_ctx","$t","_cache","args","loadNewPosts","_toDisplayString","_hoisted_5","_hoisted_6","posts","post","_component_post_item","_id","_hoisted_7","isLoading","_hoisted_8","PostItem","computed","useStore","onMounted","onUnmounted","useI18n","RequestPreloadQueue","ChannelService","PostsCounterService","components","setup","scrollComponent","activeCategory","localStorage","getItem","useScope","store","postsCounterService","getters","loadPosts","value","clearPostsCountInterval","category","dispatch","initPostsCountInterval","loadMorePosts","window","setItem","scrollTo","top","behavior","app","methods","handleScroll","scrollY","element","getBoundingClientRect","bottom","innerHeight","setCategoryLists","getChannelsCategories","activeCategoryIndex","findIndex","splice","filter","visible","unshift","length","addRequest","addEventListener","removeEventListener"],"sourceRoot":""}